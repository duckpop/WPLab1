<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<div th:fragment="listChefs" class="w-100">
    <div class="container-fluid p-4">

        <!-- Error message -->
        <div th:if="${error}" class="alert alert-danger">
            <span th:text="${error}"></span>
        </div>

        <!-- Add Chef button - only ADMIN -->
        <div class="mb-4" sec:authorize="hasRole('ADMIN')">
            <a th:href="@{/chefs/chef-form}" class="btn btn-success">
                <i class="fas fa-plus"></i> Add New Chef
            </a>
        </div>

        <!-- Select Chef with Radio Buttons -->
        <div class="card mb-4">
            <div class="card-header bg-info text-white">
                <h5 class="mb-0">Select a Chef to View Dishes</h5>
            </div>
            <div class="card-body">
                <form th:action="@{/dish}" method="get" id="chefSelectForm">
                    <div class="row">
                        <div th:each="chef : ${chefs}" class="col-md-4 mb-3">
                            <div class="form-check">
                                <input class="form-check-input"
                                       type="radio"
                                       name="chefId"
                                       th:value="${chef.id}"
                                       th:id="'chef_' + ${chef.id}">
                                <label class="form-check-label" th:for="'chef_' + ${chef.id}">
                                    <strong th:text="${chef.firstName} + ' ' + ${chef.lastName}"></strong>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Submit button -->
                    <div class="mt-3">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-arrow-right"></i> View Dishes for Selected Chef
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Chefs Table -->
        <h4 class="mt-4 mb-3">All Chefs</h4>
        <div class="table-responsive">
            <table class="table table-striped table-hover">
                <thead class="table-dark">
                <tr>
                    <th>ID</th>
                    <th>First Name</th>
                    <th>Last Name</th>
                    <th>Bio</th>
                    <th sec:authorize="hasRole('ADMIN')">Actions</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="chef : ${chefs}">
                    <td th:text="${chef.id}"></td>
                    <td th:text="${chef.firstName}"></td>
                    <td th:text="${chef.lastName}"></td>
                    <td th:text="${chef.bio}"></td>

                    <!-- Actions - only ADMIN -->
                    <td sec:authorize="hasRole('ADMIN')">
                        <a th:href="@{/chefs/chef-form/{id}(id=${chef.id})}"
                           class="btn btn-sm btn-warning">
                            <i class="fas fa-edit"></i> Edit
                        </a>
                        <form th:action="@{/chefs/delete/{id}(id=${chef.id})}"
                              method="post"
                              style="display: inline;">
                            <button type="submit"
                                    class="btn btn-sm btn-danger"
                                    onclick="return confirm('Delete this chef?')">
                                <i class="fas fa-trash"></i> Delete
                            </button>
                        </form>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>

        <!-- Empty state -->
        <div th:if="${chefs.isEmpty()}" class="text-center py-5">
            <h4>No chefs found</h4>
            <p sec:authorize="hasRole('ADMIN')">
                <a th:href="@{/chefs/chef-form}">Add the first chef</a>
            </p>
        </div>
    </div>
</div>
</html>
